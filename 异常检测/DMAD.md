---
Publish: arXiv
监督方式: 有监督
Year: "2024"
文档链接: "[[2403.12362 DMAD.pdf]]"
---

[[2403.12362 DMAD.pdf]]
现有的异常检测方法仅使用正常样本进行训练，忽视了真实场景中能够获取的非常少量但是非常重要的异常样本。
本文将异常检测算法分类两类：
- 无监督的和半监督的。
- 统一的（多类）和分离的（单类）

|     | 无监督                                   | 半监督                                                                                              |
| --- | ------------------------------------- | ------------------------------------------------------------------------------------------------ |
| 统一  | [[UniAD]]<br>[[OmiAL]]                | [[DMAD]]                                                                                         |
| 分离  | [[RDA]]<br>[[PaDiM]]<br>[[SimpleNet]] | [[DRA]]<br>[[Prototypical Residual Network]]<br>[[BGAD]] |

#### 参考文献
[[DeepSAD]]
[[DRA]]
[[Prototypical Residual Network]]
[[BGAD]]

# 摘要

训练统一模型被认为更适合实际工业异常检测场景，因为它具有泛化能力和存储效率。然而，这种多类别设置仅使用正常数据，忽略了现实世界中少量但重要的可访问注释异常。为了解决现实世界异常检测的挑战，我们提出了一个名为双存储增强表示学习的异常检测框架（DMAD）。该框架在统一（多类别）设置中处理无监督和半监督场景。DMAD采用双存储库来计算正常和异常模式之间的特征距离和特征注意力，从而封装了关于正常和异常实例的知识。然后，利用这些知识构建了用于异常评分学习的增强表示。我们在MVTec-AD和VisA数据集上评估了DMAD。结果表明，DMAD超越了当前最先进的方法，突显了DMAD在处理现实世界异常检测场景复杂性方面的能力。代码将会公开提供。

# 引言

图像异常检测（Image Anomaly Detection），也称为表面缺陷检测（Surface Defect Detection），是一种将图像分类为正常和异常类别，并在像素级别确定异常的过程。基于深度学习的异常检测方法相较于手动异常定位表现出更高的效率。目前主流的方法通常为每个对象训练一个独特的模型，如图1（a）左下角所示。然而，随着对象类别数量的快速增长，这种方法导致了存储消耗的增加。为了解决这个问题，UniAD [25]提出了一个多类别设置，利用所有对象的正常数据来训练一个统一的模型，如图1（a）左上角所示。此外，在假设异常数据不可用的情况下，当前的异常检测方法 [6, 14, 23, 31] 主要依赖于无监督学习。它们明确定义了正常数据的边界，如图1（a）左侧所示。然而，由于在训练过程中缺乏真实的异常数据，特别是在处理轻微缺陷时，这些边界可能缺乏足够的准确性。最近的研究 [8,16,24,28] 表明，在现实世界的情况下获取少量的异常是可行的。这些半监督方法，如图1（a）右下角所示，可以帮助模型预测潜在的异常模式并增强其性能。在我们的提议中，针对现实世界的异常检测，训练一个统一的模型更加合适。此外，除了无监督场景外，还需要考虑半监督场景，其中提供了少量注释的异常。我们将这种带有少量注释异常的新统一设置称为统一半监督设置，如图1（a）右上角所示。这种新设置填补了研究空白。

在统一半监督设置下，模型利用所有对象类别的数据，包括正常数据、可见异常数据以及它们的对应监督信息进行训练。这种方法具有几个优点。首先，它与实际情况更加贴近，因为总是有一些注释的异常可供使用。其次，这种设置更加统一和方便，因为所有数据，包括注释，都由一个单一模型利用。第三，我们观察到在不同对象类别中存在视觉上的常见缺陷，如图1（b）所示。通过采用这种设置进行异常检测，这些相似的缺陷可以在训练过程中提供额外的优势。这种设置的挑战在于准确地建模多类别分布，同时避免对可见异常过拟合，并有效利用可见异常。为了解决这个问题，我们提出了一个新颖的框架：双存储增强表示学习的异常检测（DMAD）。DMAD不仅适用于统一半监督设置，还适用于一般统一（多类别）设置，其中没有可用的注释异常。这使得它非常适用于现实世界的异常检测，其中异常可能最初不可访问。然而，随着系统的运行，某些注释的异常可能会出现以供使用。

具体来说，DMAD首先利用一个补丁特征编码器提取补丁特征。为了建立一个统一的决策边界，构建了一个双存储库，包括一个正常存储库和一个变量异常存储库。在无监督情况下，从正常和异常特征的特征融合中生成的伪异常特征集被用作异常存储库。在半监督场景中，为了缓解数据不平衡，我们采用了异常中心采样策略。该策略扩展了异常存储库，补充了观察到的异常和伪异常特征集。双存储库计算了补丁特征与其在两个存储库中最近特征之间的距离和交叉注意力，创建了关于正常数据和异常数据的知识库。特征本身及其两个计算出的知识组成了一个增强表示。最后，我们使用多层感知器（MLP）来学习这个表示与异常分数之间的映射。

总之，我们的贡献如下：

1. 为了解决实际世界的异常检测问题，包括通用统一设置和统一半监督设置，我们提出了一个基于双存储库的新框架，名为DMAD。DMAD利用正常存储库和可变异常存储库来处理这两种情况。
2. 为了有效利用双存储库，我们引入了一个知识增强模块。该模块计算距离和交叉注意力，形成一个知识表示，有助于改进异常分数的学习。
3. 我们在MVTec-AD和VisA数据集上进行了大量实验。结果表明，我们的模型在各种设置下明显优于当前最先进的竞争对手。

# 相关工作

## Multi-class Unsupervised Anomaly Detection

