---
Publish: CSUR2020
Year: "2020"
Month: "12"
文档链接: https://arxiv.org/pdf/2012.02364.pdf
创新点: 第一篇基于深度学习的医学异常检测综述
---
## Abstract

基于机器学习的医学异常检测是一个被广泛研究的重要问题。在各种医学应用领域中提出了许多方法，我们观察到这些不同应用之间存在一些相似之处。尽管存在这种可比性，但我们观察到这些多样化研究应用缺乏结构化组织，以便能够研究它们的优点和局限性。本调查的主要目标是提供对医学异常检测中流行的深度学习技术进行彻底的理论分析。特别地，我们提供了对最先进技术的连贯和系统的审查，比较和对比它们的架构差异以及训练算法。此外，我们提供了深度模型解释策略的全面概述，这些策略可用于解释模型的决策。另外，我们概述了现有深度医学异常检测技术的主要局限性，并提出了进一步研究的关键方向。

## I. INTRODUCTION

在异常检测中，识别不符合整体数据分布的数据样本是主要任务。异常可能由于数据捕获过程中的噪声、基础现象的变化，或者由于捕获环境中的新条件或先前未见条件而产生。因此，异常检测在医学信号分析中是至关重要的任务。

深度学习的兴起彻底改变了机器学习领域，其成功也渗透到了医学异常检测领域，导致了大量利用深度机器学习架构进行医学异常检测的研究文章。

本次调查的主要目标是对现有文献进行结构化和全面的审查，系统地比较和对比方法。此外，我们还对深度模型解释策略进行了广泛调查，这在将“黑箱”深度模型应用于医学诊断并理解为何做出决策时至关重要。此外，我们总结了现有研究的挑战和局限性，并确定了关键的未来研究方向，为深度学习在医学异常检测中的普遍有效应用铺平了道路。

### A. What are Anomalies?

异常检测是识别分布之外的示例的任务。简而言之，它旨在检测不符合数据集中一般模式的示例。这是一个至关重要的任务，因为异常观测与问题或故障类型相关，如结构缺陷、系统或恶意软件入侵、生产错误、金融欺诈或健康问题。尽管定义简单直接，但在机器学习中识别异常是一项具有挑战性的任务。主要挑战之一来自不同异常的不一致行为，以及关于什么构成异常的持续定义的缺乏。例如，在特定情境下，某种心率可能是正常的，而在不同的情境下，它可能表示健康问题。此外，噪声数据捕获设置和/或监测环境中的动态变化可能导致正常示例出现为分布之外的样本（即异常），从而产生更高的假阳性率。因此，需要具有高建模能力的智能学习策略，以更好地将异常样本与正常数据区分开来。

### B. Why are Medical Anomalies Different?

图1中的图示了与机器学习下医学数据处理相关的主要阶段，以及每个阶段与异常检测的关系。收集的生理数据被分析并通常用于 i) 预测和/或 ii) 诊断。预测任务包括预测生理信号的未来状态，如血压，或其他特征，如康复速率。对于诊断任务，分析数据的一部分用于识别特定医学状况的病理特征。异常检测与预测和诊断任务都有关系，因为它捕获了生理数据的独特特征，这些特征可能提供有关数据或患者的信息。

与其他应用领域类似，医学异常检测也继承了第I-A节描述的挑战。例如，图2(a)展示了来自**Kvasir内窥镜图像数据集**的两个示例。尽管它们在视觉上非常相似，左图是正常盲肠类别的示例，而右图是溃疡性结肠炎疾病类别的示例。图2(b)中的另一个示例展示了典型医学数据集中正常数据的多样性特点。这些示例是来自PhysioNet心脏计算挑战赛2016的心音记录。顶部图展示了清晰的正常心音记录。而第二排的图则表示在数据捕获过程中被噪声干扰的正常类别的记录。因此，在对正常示例进行建模时，模型应具有代表正常数据分布多样性的能力。除了这些固有挑战之外，医学异常检测还存在特定应用的额外障碍。首先，由于最终应用主要是医学诊断，测试灵敏度（正确识别异常样本的能力）是一个决定性和关键因素，异常检测模型需要具有高度准确性。其次，有许多患者特定特征导致不同数据样本之间存在差异。例如，在[7]中，作者发现根据EEG数据，来自不同人口统计学特征的儿童的休息状态存在显著差异。不同年龄组、性别等之间也存在显著差异。因此，在设计准确的医学异常检测框架时，应采取措施缓解这些障碍。考虑到这些挑战，医学异常检测通常被提出作为一个监督学习任务，其中模型被提供了监督信号，以便学习区分正常和异常示例。这与其他领域（如生产缺陷检测或金融欺诈检测）中以无监督方式检测异常的方法形成对比。

## C. Why use Deep Learning for Medical Anomaly Detection?

深度学习在生物医学工程领域越来越受到研究人员的青睐，因为它提供了一种应对上述挑战的方式。深度学习的一个显著特征是其建模非线性的能力。增加模型中的非线性可以更好地区分正常和异常样本，并更好地建模数据中的不一致性。深度学习带来的另一个优点是其自动特征学习能力。大数据的可用性和增加的计算资源赋予了深度学习的层次特征学习过程能力，避免了明确手工制作和定义什么构成异常的需求。深度学习的另一个有趣特征是其能够通过神经网络架构无缝地发现数据中的长期关系，而无需在特征设计过程中明确定义它们。例如，循环架构（如长短期记忆网络（LSTM）[10]和门控循环单元（GRU）[11]）可以使用所谓的“记忆”高效地对时间序列数据中的时间关系进行建模。

### D. Our Contributions

尽管一些最近的调查文章[3]，[2]涉及了医学异常检测领域，尽管已经发表了许多关于特定医学应用领域的调查论文[12]，[13]，[14]，[15]，[16]，但**尚无深度学习基础的医学异常检测技术的系统评述**，这种评述可以让读者比较和对比不同深度学习技术的优缺点，并将这些发现应用于不同的医学应用领域。表I总结了这些限制。本文直接解决了这一需求，并提供了对流行的深度学习模型架构的彻底理论分析，包括卷积神经网络、循环神经网络、生成对抗网络、自动编码器和神经记忆网络；以及它们在医学异常检测中的应用。此外，我们广泛分析了不同的模型训练策略，包括无监督学习、监督学习和多任务学习。

此外，本文提供了深度模型解释策略的全面概述，这些策略可用于解释模型的决策。该分析系统地说明了这些方法如何生成与模型无关的解释以及将这些方法应用于医学数据时的局限性。 最后，本文详细介绍了现有深度医学异常检测方法的局限性，并列出了关键的研究方向，鼓励读者将其未来的研究方向引向可推广和可解释的深度医学异常检测框架，以及概率和因果方法，这些方法可能揭示数据中的因果关系。

### E. Organisation

在第二节中，我们展示了深度异常检测算法的不同方面，说明了这些架构的动机，并突显了医学异常检测所涉及的复杂性。具体来说，第二节-A部分展示了医学异常检测领域可用数据的类型，以及不同的深度学习架构是如何设计来从不同模态中捕获信息的。第二节-B部分根据它们的训练目标对深度异常检测架构进行分类，讨论了这些算法背后的理论以及它们的优点和缺点。第二节-C提供了深度医学异常检测已应用于的关键应用领域的概述。在第三节中，我们理论上概述了深度模型解释策略，这是在医学应用中部署深度模型时的一个关键考虑因素。第四节说明了现有深度异常检测框架的一些挑战和限制，并提供了未来的研究方向。第五节包含了结论性的评论。

## II. DETECTING MEDICAL ANOMALIES WITH DEEP LEARNING

在本节中，我们确定了深度医学异常检测算法的不同方面，包括使用的数据类型、不同的算法架构以及考虑的不同应用领域。以下各小节讨论了每个类别中现有的深度医学异常检测算法。

### A. 数据类型

生物医学信号可以广泛分类为生物医学图像、电生物医学信号和其他生物医学数据，如实验室结果数据、音频记录和可穿戴医疗设备数据。以下各小节简要讨论了流行的应用场景。我们还将读者指向补充资料，在那里我们提供了关于每个类别的更全面的讨论。
#### 生物医学成像

1. X射线摄影：X射线的波长比可见光短，可以穿过人体大多数组织类型。然而，骨骼中含有的钙密度较高，会散射X射线。位于X射线源相对位置的胶片呈负像，暴露在更多光线下的区域会显得更暗。因此，当更多的X射线穿透肺部和肌肉等组织时，这些区域在胶片上变暗，而骨骼则呈现为更亮的区域。X射线成像通常用于各种诊断目的，包括检测骨折、牙科问题、肺炎和某些类型的肿瘤。 
2. 计算机断层扫描（CT）：在CT成像中，通过在患者迅速旋转时发射窄束的**X射线**来生成身体的横截面图像。CT成像收集了许多横截面切片，这些切片堆叠在一起生成了一个三维表示，比传统的X射线图像更具信息量。CT扫描是一种常用的诊断工具，用于识别身体各个部位的疾病或损伤。应用包括检测腹部肿瘤或病变，以及定位头部受伤、肿瘤和血栓。它们还用于诊断复杂的骨折和骨肿瘤。 
3. 磁共振成像（MRI）：正如其名称所示，MRI利用磁场进行成像，通过迫使人体中的质子与施加的磁场保持一致。具体来说，人体中的质子会旋转并产生一个小磁场。当引入像MRI机器产生的**强磁场**时，质子会与该磁场保持一致。然后，引入一个无线电频率脉冲来扰乱这种排列。当无线电频率脉冲关闭时，质子释放能量并试图重新与磁场保持一致。不同组织类型释放的能量不同，使得MRI扫描能够分隔不同的区域。因此，MRI通常用于成像人体的非骨或软组织区域。比较研究表明，与CT扫描相比，大脑、脊髓、神经和肌肉更适合通过MRI捕获。因此，**MRI是进行任务如脑肿瘤检测和识别组织损伤的首选模态**。 

除了这些流行的生物医学成像传感器类别外，还存在其他常见的数据源，如正电子发射断层扫描（PET）、超声波和医学光学成像。图3提供了不同医学成像信号类型的示例。在补充材料的第1.1节中，我们对这些不同的数据源进行了全面讨论，包括对它们在深度学习中的最新应用进行了讨论，并列出了一些公开可用的数据集。

#### 电生物医学信号

1. 心电图（ECG）：ECG是可视化通过心脏流动的电流的工具，这导致心跳，并从心脏顶部开始并向底部传播。在静止状态下，心脏细胞与外部环境相比呈负电荷，当它们变为去极化状态时，它们变为正电荷。ECG捕获了去极化的差异。通过分析ECG可以提取两种类型的信息[17]。首先，通过在ECG上测量时间间隔，可以筛查不规则的电活动。其次，电活动的强度提供了心脏过度工作或受到压力的区域的指示。 脑电图（EEG）：EEG检测大脑中的电活动，大脑利用电脉冲进行通信。为了捕获电活动，将小金属盘（电极）放置在头皮上。这些电极捕获的电信号被放大以更好地可视化脑活动。 EEG是观察受试者认知过程的重要工具。它们经常用于研究睡眠模式、心理障碍、头部受伤的脑损伤和癫痫。 
2. 脑磁图（MEG）：如上所述，EEG捕获了人类大脑细胞外电流产生的电场，而MEG主要检测这些细胞外电流诱导的磁场[18]。我们承认MEG不是一种电生物医学信号，但是我们将MEG与其他电信号一起列出，因为它捕获了大脑电活动的副产品。一些研究[19]，[20]，[21]，[22]，[23]，[24]已经调查了MEG信号用于检测异常脑活动和病情的效用。 除了ECG、EEG和MEG这些最常用的电生物医学信号之外，我们还想提到肌电图（EMG）传感器，其中监测由肌肉细胞产生的电位以诊断肌肉和运动神经元的健康。我们将读者引向补充材料的第1.2节，其中更全面地讨论了与ECG、EEG、MEG、EMG相关的内容，以及与它们在深度学习研究中的最新应用相关的讨论以及公开可用的数据集列表。
3. 其他数据类型：除了上述主要数据类型之外，我们还想提到其他杂项数据源，如心音图（PCG）和可穿戴医疗设备，它们也为医学诊断提供了有用的信息。我们将读者引向补充材料的第1.3节，其中我们详细讨论了这些数据源，提供了与它们在深度学习研究中的最新应用相关的讨论。 

### B. 医学异常检测的算法方法

在本小节中，我们根据它们的训练目标总结了现有的深度学习算法，以及在训练期间是否提供了正常/异常的标签。此外，第II-B3小节总结了医学领域中常用的递归深度神经网络架构。最后，介绍了不同数据类型之间的维度差异，并介绍了现有深度学习研究是如何处理这些差异的。

#### 无监督异常检测

在无监督异常检测中，训练期间不提供监督信号（指示样本是否正常或异常）。因此，无监督算法不需要标记的数据集，这使它们受到机器学习社区的青睐。自动编码器（AEs）和生成对抗网络（GANs）是两种常见的无监督深度学习架构，在以下小节中进行了介绍。

【自动编码器（AEs）】自从它们在[25]中被引入作为预训练深度神经网络的方法以来，AEs已广泛用于自动特征学习[26]。图4显示了AE的结构。它们是对称的，模型被训练来从学习的压缩表示中重新构造输入，该表示位于架构的中心。

### C. 背景和相关应用

本小节详细讨论了深度医学异常检测中的流行应用领域，说明了如何利用先前讨论的架构变体在这些领域中应用。

#### 基于MRI的异常检测

在本节中，我们总结了基于深度学习的MRI数据异常检测中的一些关键最近文献。融合模态是最近MRI分析的一项流行研究方向。在[59]中，作者研究了T1加权（T1w）MRI和MRIs的髓鞘水成像（这是一种专门测量髓鞘含量的定量MRI技术）的融合，用于多发性硬化（MS）的诊断。在他们提出的架构中，他们利用两个模态特定的深度信念网络（DBN）[60]从单个T1w和髓鞘图中提取特征。然后，通过一个多模态DBN联合学习两种模态的互补信息。他们通过连接多模态DBN的顶层隐藏单元激活来检索多模态特征向量。作为最后一步，使用随机森林[61]来训练以检测异常。所提出的算法使用内部数据集进行验证，该数据集包括55名复发性缓解型MS患者和44名健康对照者。T1w和髓鞘图模态的分类准确率分别为70.1 ± 13.6%和83.8 ± 11.0%，而融合表示达到了87.9 ± 8.4%。 [62]提出了一种融合MRI图像和氟代脱氧葡萄糖正电子发射断层扫描（FDG-PET）样本的策略。在他们的方法中，作者首先将MRI图像分割为灰质和白质区域，然后将灰质细分为87个解剖兴趣区域（ROI）。然后，从这些区域中提取1488、705和343大小的补丁。从FDG-PET图像中也提取类似大小的补丁。然后，使用6个独立的具有稠密层的深度神经网络（DNN）来嵌入补丁信息，并使用另一个DNN来融合编码嵌入。使用softmax层生成最终的异常分类。作者利用这种架构来检测与阿尔茨海默病相关的病理。该框架使用公开可用的阿尔茨海默病神经影像倡议（ADNI）数据库[63]进行评估，该数据库包含1242个受试者。所提出的方法在准确性方面达到了82.93%，比仅使用FDG-PET获得了约1.5%的改进。 [64]提出了一种融合MRI的表观扩散系数（ADCs）与T2加权MRI图像（T2w）的方法。与预测单个分数级别分类相反，他们提出了一种输出每种模态的分割图的方法，指示每个像素属于感兴趣类的可能性。他们提出利用新颖的相似性损失函数，使ADC和T2WI流产生一致的预测，从而允许在流之间共享互补信息。初始分割图与手工特征组合，并通过支持向量机（SVM）传递以生成最终的预测。使用包含364名受试者的数据集进行评估，其中包含463个前列腺癌病灶和450个确定的非癌症图像补丁，该框架实现了89.85%的敏感性和95.83%的特异性，用于区分癌症和非癌症组织。 

与以上方法采用特征级融合不同，[65]提出了一种使用决策级融合的架构。所提出的方法具有由3个单独训练的卷积神经网络组成的分类器集合。每个网络提供一个softmax分类，表示四个阿尔茨海默病类别的可能性：非痴呆、非常轻微、轻微和中度。使用多数投票进行个别分类的融合。评估在公开的OASIS数据集[66]上进行，该数据集包含416个受试者，所提出的集成方法达到了94%的精度和93%的召回率。 尽管存在架构差异，上述讨论的方法都是受监督的深度卷积神经网络（DCNN）模型，这些模型主导了基于MRI的异常检测文献。这明显受到了受监督CNN模型在从二维输入中提取任务特定空间信息方面高效的启发。 尽管受监督DCNN模型普遍存在，但也有一些方法使用了自动编码器（AE）[67]，[68]。在[68]中，提出了一种带有稀疏性约束的AE网络，用于诊断患有精神分裂症的个体。首先，AE以无监督方式进行特征提取，然后在第二阶段，作者使用数据集的验证集在将softmax层添加到AE后微调网络。作为最后阶段，使用线性支持向量机对样本进行分类。该系统使用从7个图像来源收集的大规模MRI数据集进行验证，其中包括474名精神分裂症患者和607名健康对照者。该模型在k折交叉验证设置中达到了约85%的准确率。

同样，在[67]中，AE被训练用于早期检测急性肾移植排斥。作为第一阶段，AE以无监督方式训练。为了对输入进行分类，删除AE的解码器，并使用监督学习训练softmax层。该方法在100名受试者的一次留一子实验设置中实现了97%的分类准确率。 需要注意的是，与第II-B1节中讨论的无监督AE模型不同，这些模型不是纯粹的无监督架构。在AE的初步训练之后，添加了分类层，并使用监督信号进行训练以检测异常。 在另一项工作中，[69]提出了一个多尺度多任务学习框架，用于诊断椎间孔狭窄症（LNFS）。图9展示了所使用的架构。作者表明，每个腰椎图像可以在各种尺度上捕获多个器官。此外，他们说明了可以使用多任务学习，从而学习来自多个相关任务的学习，如第II-B2节中讨论的那样，我们注意到这种策略在多个应用领域中都存在。在多个尺度上提取特征图，在每个级别上，模型试图执行两个任务，即边界框的回归以定位器官，并预测定位器官中的异常。该系统使用200名临床患者进行验证，能够诊断异常的神经孔道，精确度为0.83，召回率为0.8。