---
Publish: IPMI2017
Year: "2017"
---

## 摘要

获得捕获与疾病进展和治疗监测相关的成像标志物的模型具有挑战性。模型通常基于大量数据，并带有已知标记的注释示例，旨在自动检测。高注释工作量和对已知标记词汇表的限制限制了这种方法的威力。在这里，我们进行无监督学习，以识别成像数据中的异常作为标记的候选者。我们提出了 AnoGAN，这是一种深度卷积生成对抗网络，用于学习正常解剖变异性的流形，并伴随着一种基于从图像空间到潜在空间映射的新型异常评分方案。应用于新数据后，该模型会标记异常，并对图像斑块进行评分，表明它们适合学习分布。**视网膜光学相干断层扫描图像**的结果表明，该方法可以正确识别异常图像，例如包含视网膜液或高反射病灶的图像。

## 引言

在诊断、监测疾病进展或治疗反应的过程中，**影像学数据**中疾病标志物的检测和量化至关重要。依赖已知标记的词汇限制了包含更丰富相关信息的成像数据的使用。在这里，我们证明了可以通过对大规模成像数据的无监督学习来识别相关_异常_。

医学成像能够观察与疾病状态和治疗反应相关的标志物。虽然已知的标志物种类繁多（例如，脑肿瘤的特征性图像外观或乳腺筛查中的钙化模式），但许多疾病缺乏足够广泛的标志物， 而在其他情况下，标记物的预测能力是有限的。此外，即使预测标志物是已知的，它们在成像数据中的计算检测通常也需要使用大量注释数据（如标记病变）进行广泛的监督训练。这限制了我们利用成像数据做出治疗决策的能力。

在这里，我们提出了无监督学习，以创建一个丰富的健康局部解剖外观生成模型。我们展示了生成对抗网络 （GAN） 如何解决创建具有足够代表性的外观模型的核心问题，同时学习生成和判别组件。我们提出了一种改进的从图像空间到潜在空间的映射技术。我们使用这两个组件来区分符合训练数据的观测值和不符合训练数据的数据。

## 相关工作

异常检测的任务是识别与训练期间看到的正态数据分布不匹配的测试数据。异常检测方法存在于各个领域，包括视频分析[1]到遥感[2].它们通常使用特征空间中正态数据分布的显式表示，并根据观测点在特征空间中位置的局部密度确定异常值。Carrera等人。[3]利用卷积稀疏模型来学习滤波器字典，以检测纹理图像中的异常区域。Erfani 等人。[4]提出了一种使用一类支持向量机（SVM）的无监督异常检测混合模型。SVM 是从深度信念网络 （DBN） 学习的特征中训练出来的。上述工作中的实验是在现实生活中的数据集上进行的，这些数据集包括一维输入、合成数据或纹理图像，与医学图像相比，这些数据集具有较低的维度或不同的数据特征。对异常检测研究论文的调查可以在以下位置找到[5].在临床光学相干断层扫描 （OCT） 扫描分析中，Venhuizen 等人。[6]使用词袋特征作为监督随机森林分类器训练的基础，以区分患病患者和健康受试者。Schlegl 等人。[7]利用卷积神经网络，通过基于从医学报告中提取的病理-位置对的语义描述的弱监督学习来分割 OCT 数据中的视网膜液区域。与我们的方法相反，这两部作品都使用了某种形式的监督进行分类器训练。Seeböck 等人。[8]通过对健康样本的无监督学习，使用卷积自动编码器和一类 SVM 识别 OCT 图像中的异常区域，并探索不同类别的异常。与这项工作相比，SVM 在[8]需要选择一个超参数来定义估计的健康区域所覆盖的训练点的数量。

GANs能够学习生成模型，生成详细的逼真图像[9,10,11].Radford等人。[12]引入了深度卷积生成对抗网络 （DCGAN），并表明 GAN 能够捕获语义图像内容，从而实现视觉概念的向量算术。 Yeh等人。[13]在自然图像上训练 GAN，并将训练后的模型应用于语义图像修复。与Yeh等人相比。[13]，我们实现了两个适应，以改进从图像到潜在空间的映射。 我们在整个查询的潜在空间中进行搜索 图像，并提出一种新的变体来指导潜在空间中的搜索（受特征匹配的启发[14]).此外，我们还定义了一个异常分数，这在修复任务中是不需要的。本文与上述异常检测工作的主要区别在于生成模型和耦合映射模式的代表性，它利用经过训练的DCGAN，能够准确区分**正常解剖结构**和**局部异常外观**。这使得大规模检测细微异常变得可行。

## 贡献

在本文中，我们提出了对正常外观的生成模型（参见图 1 中的蓝色块）的对抗训练，如第 2.1 节所述，以及耦合映射模式，如第 2.2 节所述，能够评估新数据（第 2.3 节）以识别异常图像并分割成像数据中的异常区域（参见图 1 中的红色块). 从光谱域 OCT （SD-OCT） 扫描中提取的标记测试数据的实验表明，这种方法可以高精度地识别已知异常，同时检测没有体素级注释的其他异常。 据我们所知，**这是第一项将GAN用于异常或新颖性检测的工作**。此外，我们提出了一种新的映射方法，可以解决图像前的问题。

## 生成对抗性表示学习识别异常

为了识别异常，我们学习了一个基于 GAN 表示正常解剖变异性的模型[13].该方法训练生成模型和判别器，以**同时区分生成的数据和真实数据**（见图2（a））。它不是单一的成本函数优化，而是以成本的纳什均衡为目标，增加了生成模型的代表性能力和特异性，同时在对实际数据和生成数据进行分类方面变得更加准确，并改进了相应的特征映射。在下文中，我们将解释如何构建此模型（第 2.1 节），以及如何使用它来识别训练数据中不存在的外观（第 2.2 节和第 2.3 节）。

## 实验

### 数据、数据选择和预处理

我们在视网膜的临床高分辨率 SD-OCT volumes上评估了该方法，每体积 49 次 B 扫描（代表 zx 平面中的图像切片），总体积分辨率496×512×49体素分别位于 z、x 和 y 方向。**GAN 使用从 270 个健康受试者的临床 OCT volumes中提取的 2D 图像贴片进行训练**，这些贴片是根据 OCT 体积不包含液体区域的标准选择的。为了进行测试，从另外 10 例健康病例和 10 例病理病例中提取了含有视网膜液的贴片。 OCT 卷按以下方式进行预处理。灰度值归一化为从 -1 到 1 的范围。卷在 x 方向上调整为大小 22微米产生大约 256 列。提取视网膜区域并压平以调整方向、形状和厚度的变化。我们使用了以下自动图层分割算法[15]找到视网膜的顶层和底层，这些层定义了视网膜在 z 方向上的边界。从这些归一化和扁平化的体积中，我们总共提取了 1.000.000 个图像分辨率为 64 × 64 随机采样位置的像素。原始数据和预处理的图像表示如图 1 所示。 测试集总共由 8192 个图像贴片组成，包括来自训练集中未包含的病例的正常和病理样本。对于病理 OCT 扫描，可以使用临床视网膜专家对液体和非液体区域的体素注释。这些注释仅用于统计评估，但从未在训练和评估阶段输入网络。为了评估检测性能，如果图像包含至少一个注释为视网膜液的像素，则我们为图像分配了一个阳性标签。