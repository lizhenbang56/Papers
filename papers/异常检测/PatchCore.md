---
Publish: CVPR2022
文档链接: https://arxiv.org/pdf/2106.08265.pdf
Year: "2021"
Month: "06"
代码: https://github.com/amazon-science/patchcore-inspection
Stars: "619"
---
- PatchCore 在 MVTec-AD 上的无监督设置下实现了 99.3% 的图像级 AUC，但在使用统一阈值进行推断时，其准确率降至了 79.76%。——[[AnomalyGPT]]

## 摘要

能够识别有缺陷的零件在大规模工业制造中是一个至关重要的组成部分。我们在这项工作中要解决的一个特殊挑战是冷启动问题：仅使用正常（非有缺陷）的示例图像来拟合模型。虽然针对每个类别的手工解决方案是可能的，但目标是构建能够同时在许多不同任务上自动运行的系统。性能最佳的方法是将来自ImageNet模型的嵌入与异常检测模型相结合。在这篇论文中，我们延伸了这一工作，并提出了PatchCore，它使用最大限度的代表性存储器库来存储正常补丁特征。PatchCore在达到最先进性能的同时，提供了竞争性的推理时间，同时实现了检测和定位的最先进性能。在具有挑战性的广泛使用的MVTec AD基准测试中，PatchCore实现了高达99.6%的图像级异常检测AUROC分数，与下一个最佳竞争对手相比，错误减少了一半以上。我们还在另外两个数据集上报告了竞争性结果，并在少样本情况下发现了竞争性结果。代码：github.com/amazon-research/patchcore-inspection。

## 1. Introduction

人类的认知深深地融入了在图像中检测异常模式的能力。人类能够在只看过少量正常实例后区分数据中的预期变化和异常值。在这项工作中，我们解决了这个问题的计算版本，即冷启动异常检测，用于工业图像数据的视觉检查。这种问题在许多工业场景中都会出现，其中获取正常示例图像很容易，但是指定预期的缺陷变化却是昂贵且复杂的。

这个任务自然被看作是一个分布外检测（out-of-distribution detection）问题，模型需要区分从训练数据分布中绘制的样本和其支持范围之外的样本。工业视觉缺陷分类特别困难，因为错误可能从细微的变化（如细小划痕）到较大的结构缺陷（如缺失组件）都有所体现。图1显示了MVTec AD基准数据集中的一些示例，以及我们提出的方法的结果。现有的冷启动工业视觉异常检测工作依赖于通过自编码方法、GANs或其他无监督适应方法学习正常分布的模型。最近，一些研究提出利用ImageNet分类的常见深度表示，而无需适应目标分布。尽管缺少适应性，但这些模型提供了强大的异常检测性能，甚至对缺陷进行了可靠的空间定位。这些技术的关键原则是在利用深度特征表示的多尺度性质的同时，对测试样本和正常样本进行特征匹配。精细的缺陷分割由高分辨率特征覆盖，而结构偏差和完整的图像级异常检测则应该由更高抽象级别的特征覆盖。由于这种方法是非自适应的，其固有缺点是在更高抽象级别上的匹配置信度有限：ImageNet训练中的高级抽象特征与工业环境中所需的抽象特征几乎没有相符。此外，在测试时可用的正常上下文受到可提取的高级特征表示数量的限制。在本文中，我们提出PatchCore作为一种有效的方法，通过（1）在测试时最大化可用的正常信息，（2）减少对ImageNet类的偏见，并且（3）保留高速推理。由于一张图像只要有一个补丁是异常的就可以被归类为异常，PatchCore通过利用局部聚合的中间级别特征补丁来实现这一点。中间级别网络补丁特征的使用使得PatchCore在高分辨率上能够以最小的偏见对ImageNet类进行操作，同时对局部邻域进行特征聚合确保了足够的空间上下文。这导致了一个广泛的存储库，使PatchCore能够在测试时最优地利用可用的正常上下文。最后，为了实际适用性，PatchCore还引入了贪心核心子采样作为一种关键元素，用于减少在提取的补丁级别内存库中的冗余，并显著降低存储内存和推理时间，使PatchCore在实际工业用例中非常具有吸引力。对多样化的MVTec AD以及专门的磁砖缺陷（MTD）工业异常检测基准进行了彻底的实验，展示了PatchCore在工业异常检测中的强大能力。它在MVTec AD和MTD上实现了最先进的图像级别检测得分，MVTec AD几乎完美（达到AUROC 99.6%），将先前方法的检测错误减少了一半以上，以及最先进的工业异常定位性能。PatchCore实现了这一点，同时保持快速的推理时间，而无需在手头的数据集上进行训练。这使PatchCore在工业异常检测的实际应用中非常有吸引力。此外，进一步的实验展示了PatchCore的高样本效率，与现有的异常检测方法在性能上匹敌，同时仅使用一小部分正常训练数据（nominal training data）。