---
Publish: CVPR2024
Year: "2024"
Url: https://arxiv.org/pdf/2403.05897.pdf
创新点: 生成异常图像
Month: "03"
---
## 摘要

自我监督的特征重构方法在工业图像异常检测和定位方面显示出了有希望的进展。尽管取得了这一进展，但这些方法在合成逼真和多样化的异常样本以及解决预训练特征的特征冗余和预训练偏差方面仍然面临挑战。在这项工作中，我们引入了 RealNet，这是一个具有真实合成异常和自适应特征选择的特征重构网络。它结合了三个关键创新：首先，我们提出了强度可控的扩散异常合成（SDAS），这是一种基于扩散过程的合成策略，能够生成模仿真实异常样本分布的具有不同异常强度的样本。其次，我们开发了异常感知特征选择（AFS），这是一种选择具有代表性和区分性的预训练特征[子集](coco://sendMessage?ext=%7B%22s%24wiki_link%22%3A%22https%3A%2F%2Fm.baike.com%2Fwikiid%2F3858292080688195142%22%7D&msg=%E5%AD%90%E9%9B%86)的方法，以提高异常检测性能，同时控制计算成本。第三，我们引入了重构残差选择（RRS），这是一种自适应选择区分性残差以全面识别多个粒度级别的异常区域的策略。我们在四个基准数据集上评估了 RealNet，我们的结果表明，在图像 AUROC 和像素 AUROC 方面与当前最先进的方法相比都有显著的改进。代码、数据和模型可在 [https://github.com/cnulab/RealNet](https://github.com/cnulab/RealNet) 获得。

## 1. 引言

图像异常检测是工业生产中的一项关键任务，在质量控制和安全监控等方面具有广泛的应用。虽然自我监督方法[20,32,48,50,53]因使用合成异常来训练模型而受到关注，但它们在合成逼真和多样化的异常图像方面仍然面临挑战，尤其是生成复杂的结构异常和未见的异常类别。由于可用的异常图像和关于异常类别的先验知识的缺乏，现有方法依赖于精心设计的数据增强策略[20,32]或外部数据[48]进行异常合成，导致合成异常和真实异常之间存在显著的分布差异，从而限制了异常检测模型对现实世界应用的泛化能力。为了解决这些问题，我们引入了强度可控的扩散异常合成（SDAS），这是一种新的合成策略，生成更多与自然分布相一致的多样化样本，并提供了控制异常强度的灵活性。SDAS 使用 DDPM[16]来模拟正常样本的分布，并在采样过程中引入扰动项来生成低概率密度区域的样本。这些样本模拟了各种自然异常模式，例如老化、结构变化、异常纹理和颜色变化，如图 1 所示。与此同时，基于特征重构的异常检测[8,33,44,49,53]是另一个有前途的研究方向，它将异常图像的特征重构为正常图像的特征，并通过重构残差进行异常检测和定位。它们因简单的[范式](coco://sendMessage?ext=%7B%22s%24wiki_link%22%3A%22https%3A%2F%2Fm.baike.com%2Fwikiid%2F6047730862428129013%22%7D&msg=%E8%8C%83%E5%BC%8F)而受到相当大的关注。然而，由于特征重构的高计算需求以及缺乏有效的特征选择策略，现有方法要么采用小规模的预训练 CNN[33,44,49]进行异常检测，要么从预训练网络[8,53]中手动挑选特定层的特征用于重构。最新的工作[14]强调了特征选择的重要性，表明现有的异常检测方法[30,46]对特征选择敏感。用于异常检测的最佳预训练特征子集在不同类别之间有所不同。因此，设计一种统一的特征选择方法已成为推进异常检测的迫切需求。

在本文中，我们提出了 RealNet，这是一个特征重构框架，结合了异常感知特征选择（AFS）和重构残差选择（RRS）。RealNet 充分利用了大规模预训练 CNN 的区分能力，同时减少了特征冗余和预训练偏差，提高了异常检测性能，同时有效控制了计算需求。对于不同的类别，RealNet 选择不同的预训练特征子集用于异常检测，确保了最佳的异常检测性能，同时灵活地控制模型大小。此外，RealNet 通过自适应地丢弃缺乏异常信息的重构残差，有效地减少了漏检，并显著提高了异常区域的召回率。

总之，我们的贡献有四个方面：  
• 我们提出了 RealNet，这是一个特征重构网络，通过自适应选择预训练特征和重构残差，有效利用多尺度预训练特征进行异常检测。RealNet 在解决先前方法所遭受的计算成本限制的同时达到了最先进的性能。  
• 我们引入了强度可控的扩散异常合成（SDAS），这是一种新的异常合成策略，生成与自然分布紧密对齐的逼真和多样化的异常样本。  
• 我们在四个数据集（MVTec-AD[3]、MPDD[18]、BTAD[24]和 VisA[55]）上评估了 RealNet，使用相同的网络架构和跨数据集的超参数超越了现有的最先进方法。  
• 我们提供了合成工业异常数据集（SIA）。SIA 由 SDAS 生成，总共包含来自 36 个工业产品类别的 360,000 个异常图像。SIA 可方便地用于异常合成，以促进自我监督的异常检测方法。