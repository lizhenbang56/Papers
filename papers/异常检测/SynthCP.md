---
标题: "Synthesize then Compare: Detecting Failures and Anomalies for Semantic Segmentation"
Publish: ECCV2020
Year: "2020"
Month: "03"
文档链接: https://arxiv.org/pdf/2003.08440.pdf
代码: https://github.com/YingdaXia/SynthCP
Stars: "59"
---
## Abstract

在计算机视觉应用中，尤其是语义分割的安全关键应用，如自动驾驶和医学图像分析，检测故障和异常是构建可靠系统的基本要求。本文系统地研究了语义分割的故障和异常检测，并提出了一个统一的框架，包括两个模块，用于解决这两个相关问题。第一个模块是图像合成模块，从分割布局图生成合成图像，第二个是比较模块，计算合成图像与输入图像之间的差异。我们在三个具有挑战性的数据集上验证了我们的框架，并且大幅改善了现有技术水平，例如，在Cityscapes上的AUPR-Error提高了6％，在MSD的胰腺肿瘤分割上的Pearson相关性提高了7％，在StreetHazards异常分割上的AUPR提高了20％。

## 1 Introduction

深度神经网络[15, 19, 31, 45, 47]在各种计算机视觉任务中取得了巨大成功。然而，当它们应用于现实世界的应用，如自动驾驶[22]、医学诊断[5]和核电站监控[36]等，安全问题[1]尤其引起巨大关注，特别是在失败案例具有严重后果的情况下。因此，对于机器学习系统能够检测到失败（即错误预测）以及识别可能导致这些失败的异常（out-of-distribution，OOD）具有极大的价值。

先前关于失败检测[7, 17, 24]和异常（OOD）检测[9, 18, 33–35]的研究主要集中在**对小图像进行分类**。尽管迄今为止关于语义分割的失败检测和异常检测在文献中受到了较少关注，但它们与安全关键应用更为密切相关，例如自动驾驶和医学图像分析。语义分割的失败检测目标不仅是确定分割结果中是否存在失败，还要确定失败发生在哪里。语义分割的异常检测，也称为异常分割，与失败检测相关，其目标是在给定图像中分割出异常对象或区域。

本文的目标是构建一个可靠的警报系统，以解决语义分割的失败检测（图1(i)）和异常分割（图1(ii)）。与图像分类仅输出单个图像标签不同，语义分割输出结构化的语义布局。因此，这要求系统应能够提供比图像分类更详细的分析，即像素级的错误/置信度地图。一些先前的工作[7, 16, 26]直接将失败/异常检测策略应用于像素级别的图像分类，以估计像素级别的错误地图，但它们缺乏对分割结果结构化语义布局的考虑。

我们提出了一个统一的框架来解决语义分割的失败检测和异常检测。该框架由两个组件组成：一个图像合成模块，从分割结果合成图像以重建其输入图像，即语义分割的逆过程，以及一个比较模块，用于计算重建图像与输入图像之间的差异。我们的框架受到一个事实的启发，即语义图像合成的质量[21, 43, 48]可以通过分割网络的性能来评估。假设反之也成立，即分割结果越好，从分割结果生成的合成图像越接近输入图像。如果在分割过程中发生故障，例如，如果将一个人误分割为杆，那么从分割结果生成的合成图像就不像一个人，并且合成图像与输入图像之间应该存在明显的差异。同样，当测试图像中出现异常（OOD）对象时，它会被分类为分割结果中可能存在的任何可能的内分布对象，然后在从分割结果生成的合成图像中出现为内分布对象。因此，可以通过查找测试图像与合成图像之间的差异来识别异常对象。我们将我们的框架称为SynthCP，表示“先合成再比较”。

我们通过语义到图像的条件生成对抗网络（cGAN）[43]对这个合成过程建模，它能够对从分割布局空间到图像空间的映射进行建模。这个cGAN是在标签-图像对上训练的。给定通过语义分割模型获得的输入图像的分割结果，我们将训练好的cGAN应用于分割结果以生成重建图像。然后，重建图像和输入图像被送入比较模块以识别失败/异常。比较模块是根据任务设计的：对于失败检测，比较模块由一个孪生网络建模，输出图像级别的置信度和像素级别的置信度；对于异常分割，比较模块是通过计算由语义分割模型提取的中间特征上定义的距离来实现的。

我们在Cityscapes街景数据集、医学分割十项挑战（MSD）中的胰腺肿瘤分割数据集和StreetHazards数据集上验证了SynthCP，并展示了其在失败检测和异常分割方面优于其他方法。具体而言，在Cityscapes像素级错误预测上，我们将性能提高了约6％的AUPR-Error，在胰腺肿瘤DSC预测上提高了约7％的Pearson相关性，并在StreetHazards异常分割上提高了约20％的AUPR。

我们的贡献总结如下：

- 就我们所知，我们是第一个系统地研究语义分割的失败检测（failure detection）和异常检测（anomaly detection）的研究者。
- 我们提出了一个统一的框架SynthCP，它具有语义到图像条件GAN的优点，用于解决这两个任务。
- SynthCP在三个具有挑战性的数据集上取得了最先进的失败检测和异常分割结果。