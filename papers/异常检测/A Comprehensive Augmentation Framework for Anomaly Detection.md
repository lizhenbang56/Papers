---
Publish: AAAI2024
Url: https://arxiv.org/pdf/2308.15068.pdf
Year: "2023"
Month: "08"
创新点: 数据增强
---
数据增强方法通常被整合到异常检测模型的训练中。先前的方法主要集中在复制真实世界的异常或增加多样性，而没有考虑到不同类别之间异常标准的差异，这可能导致训练分布存在偏差。本文分析了对重建网络训练有贡献的模拟异常的关键特征，并将它们压缩为几种方法，从而通过有选择地利用适当的组合创建了一个全面的框架。此外，我们将这个框架与基于重建的方法相结合，并同时提出了一种分割训练策略，该策略缓解了过拟合问题，同时避免引入对重建过程的干扰。在MVTec异常检测数据集上进行的评估表明，我们的方法在性能上优于先前的最新方法，特别是在对象类别方面。为了评估泛化能力，我们生成了一个包含不同特征异常的模拟数据集，因为原始的测试样本只包括特定类型的异常，可能导致评估存在偏差。实验结果表明，我们的方法在有效泛化到真实世界场景中遇到的各种未预见的异常方面表现出有希望的潜力。

表面异常检测是质量检验和自动化中的重要任务。它旨在基于提供的正常样本找到异常值。许多最近的方法采用了重建方法，对正常样本的分布进行建模，然后区分异常值。重建过程的训练通常需要异常值的存在，因此数据增强通常被用作产生模拟异常的一种方式，因为收集真实样本的难度很大。在实践中，模拟异常的质量对最终重建性能至关重要。

这些数据增强方法的核心思想是随机替换正常区域的一部分值，从而创建异常。在这个过程中，会自然地引出两个问题：如何选择目标区域以及使用什么作为异常源。在先前的方法中，选择目标区域的方式包括矩形区域、疤痕（细长的矩形区域）、随机掩码和通过阈值处理得到的掩码。至于异常源，常用的包括简单的CutOut（用零替换）、随机噪声、外部纹理源以及分布采样。虽然选择多种多样的方式，但先前的解决方案基于两种常见的观点创建数据增强方法。它们要么专注于创建具有高多样性的异常，要么近似真实外观。

在本文中，我们支持在异常生成中使用多种形状和随机分布的位置。但是，我们反对那些认为模仿或近似真实异常分布可能导致最优解的经验性思想。异常检测问题以异常的不可预测性而闻名。这意味着我们不应该对真实世界中异常的外观做出任何假设。先前方法试图逼近的假设异常分布是从测试集或真实世界经验的过去观察中外推出来的一个有偏见的分布。模仿有偏见的分布会导致有偏见的解决方案，在测试集中可能提供错误的安慰，因为测试集在创建过程中与人类经验密切相关。结果因此不够代表性，这些方法的性能在真实世界中可能不那么令人满意。另一方面，其他方法试图创建具有高多样性的异常，但当前的执行方式并不令人满意，因为随机源并不能真正产生具有高多样性的异常。仅仅使用随机选择的异常源，无论是内部还是外部的，只能在值方面实现多样性，而不是在异常类型方面。先前方法所做的尝试是高度经验性的，没有进一步分析异常的性质。我们需要的是产生具有不同内在特性的异常，以从不同角度覆盖可能的情况。

从重建的角度来看，我们首先将异常分为透明和不透明两种，因为它们需要网络进行不同的处理。对于透明异常，原始的正常区域被异常覆盖但仍然可见，因此目标是检索它们。对于不透明异常，原始区域完全消失，因此目标是基于周围区域的信息进行重建。然而，这种划分的前提条件无法满足，因为在现实中正常性在一定范围内变化。接近正态分布的异常更不可能被很好地重建，因此我们另外提出了一种方法来创建接近分布的异常，紧缩正常性的决策边界。此外，我们引入了旋转异常，与先前的异常不同，因为它完全源自特定对象类别的手动定义。由于在训练期间提供具有相同方向的样本就足以学习不允许旋转，而且很难计算由旋转操作创建的异常掩码，因此我们将此操作逆向应用于允许旋转的类别，以强调其在创建异常方面的无关性。

异常模拟过程旨在实现多样性，但不加区分地使用所有增强可能导致次优结果，因为对于不同的类别，同一增强可能不被视为异常。与先前的自动化方法不同，我们认为手动干预是必要的，以确定异常模拟方法的适当组合，因为每个类别中人类对异常的定义都有所不同。因此，我们另外提出了一个简单而有效的选择策略，如果认为某些增强在创建异常时不相关，则禁用某些增强。

我们遵循先前的工作构建一个重建框架来评估我们的异常模拟方法。先前方法在解决过拟合问题时的一个关键因素是在组成异常之前对正常样本使用旋转增强。然而，这会干扰我们的新增强框架，因为旋转会在某些类别中引入异常。我们移除了对旋转增强的任意使用，并提出了一种分割训练结构来改善泛化能力。具体而言，我们将训练数据分成两半，并在重建和定位中使用不同的样本，从而为实际中重建质量下降的情况做好定位过程的准备。

在实验中，我们将我们的方法与先前的异常检测方法和使用不同增强的我们方法的其他变体进行了比较。我们的工作在基准测试中展示了最先进的性能，并进行了额外的实验来展示我们的方法在先前方法中的困难样本上的改进。我们使用一个简单的重建网络来演示不同的异常增强如何影响模拟数据集上的最终重建质量。在消融实验中，我们展示了旋转增强带来的影响，以及分割策略如何作为解决过拟合问题的替代方法。