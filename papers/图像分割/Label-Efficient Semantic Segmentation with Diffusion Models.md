---
Publish: ICLR2022
Year: "2021"
Month: "12"
Url: https://arxiv.org/pdf/2112.03126.pdf
代码: https://github.com/yandex-research/ddpm-segmentation
Author: Yandex
Stars: "615"
创新点: 用生成模型进行图像分割
---
## 摘要

最近，去噪扩散概率模型受到了广泛的研究关注，因为它们在性能上优于替代方法，如GAN，并且目前提供了最先进的生成性能。扩散模型的优越性能使它们成为几种应用中的一种有吸引力的工具，包括修复、超分辨率和语义编辑。在本文中，我们展示了扩散模型也可以作为语义分割的工具，特别是在标记数据稀缺的情况下。特别地，对于几个预训练的扩散模型，我们调查了执行逆扩散过程的马尔可夫步骤的网络的中间激活。我们展示这些激活能够有效地捕获输入图像的语义信息，并且似乎是用于分割问题的优秀的像素级表示。基于这些观察结果，我们描述了一种简单的分割方法，即使只提供了少量的训练图像，也可以工作。我们的方法在相同的人类监督下，在几个数据集上显著优于现有的替代方法。该项目的源代码是公开可用的。

## 引言

最近，去噪扩散概率模型（DDPM）已经在模拟自然图像分布方面超越了替代方法，无论是在单个样本的逼真性还是多样性方面都如此。DDPM的这些优势在应用中得到了成功利用，如着色、修复、超分辨率和语义编辑，在这些应用中，DDPM通常相比GAN获得了更令人印象深刻的结果。然而，到目前为止，DDPM尚未被利用为判别式计算机视觉问题的有效图像表示源。尽管先前的文献已经证明了各种生成范式（如GAN或自回归模型）可以用于提取常见视觉任务的表示，但不清楚DDPM是否也可以作为表示学习器。在本文中，我们在语义分割的背景下对这个问题给出了肯定的答案。
特别地，我们调查了近似于DDPM中逆扩散过程的马尔可夫步骤的U-Net网络的中间激活。直觉上，这个网络学习对其输入进行去噪，不清楚中间激活是否应该捕获高级别视觉问题所需的语义信息。尽管如此，我们展示了在某些扩散步骤上，这些激活确实捕获了这样的信息，因此，潜在地可以用作下游任务的图像表示。鉴于这些观察结果，我们提出了一种简单的语义分割方法，利用这些表示并成功地工作，即使只提供了少量的标记图像。在几个数据集上，我们展示了我们基于DDPM的分割方法在相同监督量下优于现有的基线方法。
总之，本文的贡献包括：

我们调查了最先进的DDPM学到的表示，并展示了它们捕获了对下游视觉任务有价值的高级语义信息。
我们设计了一种简单的语义分割方法，利用这些表示，并在少量标记的情况下优于替代方法。
我们将基于DDPM的表示与它们的基于GAN的对应物在相同数据集上进行了比较，并展示了在语义分割的背景下前者的优势。

## 相关工作

在这一部分，我们简要描述了与我们的工作相关的现有研究方向。扩散模型是一类生成模型，通过来自简单参数分布（通常是标准高斯）的马尔可夫链的终点来逼近真实图像的分布。每个马尔可夫步骤由一个深度神经网络建模，该网络有效地学习使用已知的高斯核反转扩散过程。Ho等人强调了扩散模型与评分匹配的等价性，表明它们是两种不同的观点，通过渐进的去噪过程将简单的已知分布转化为目标分布。最近的研究开发了更强大的模型架构以及不同的高级目标，这导致了DDPM在生成质量和多样性方面战胜GAN。DDPM已被广泛应用于多种应用，包括图像着色、超分辨率、修复和语义编辑。在我们的工作中，我们展示了可以成功地将它们用于语义分割。

**用生成模型进行图像分割**是当前一个活跃的研究方向，然而，现有的方法主要基于GAN。

第一类方法基于目前最先进的GAN的潜在空间具有与影响前景/背景像素不同的效果对应的方向的事实，这允许生成合成数据来训练分割模型。然而，这些方法目前只能执行二值分割，不清楚它们是否可以用于通用的语义分割设置。

第二类方法更与我们的研究相关，因为它们基于GAN中获得的中间表示。特别地，Zhang等人提出的方法在这些表示上训练像素类别预测模型，并确认了它们的标签效率。在实验部分，我们将Zhang等人的方法与我们基于DDPM的方法进行了比较，并展示了我们解决方案的几个独特优势。

利用生成模型进行判别任务的表示。使用生成模型作为表示学习器的实践已经被广泛研究，用于全局预测和密集预测问题。虽然先前的工作强调了这些表示的实际优势，如对分布外鲁棒性，但与基于对比学习等替代无监督方法相比，生成模型作为表示学习器受到的关注较少。主要原因可能是在复杂、多样的数据集上训练高质量生成模型的困难。然而，鉴于DDPM在ImageNet上的最近成功，可以预期这个方向将在未来受到更多关注。