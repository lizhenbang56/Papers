---
Title: Segment Every Out-of-Distribution Object
Publish: CVPR2024
Url: https://arxiv.org/pdf/2311.16516.pdf
Year: "2023"
Month: "11"
Author: 哈佛大学
创新点: 对于每个像素点，为每个类别计算分数。
---
## 摘要

语义分割模型在分布类别方面表现出色，但在真实世界的部署中面临着识别到的分布之外的对象的挑战。检测这些分布之外的对象对于安全关键应用至关重要。现有方法依赖于异常得分，但选择适当的阈值生成掩模存在困难，并可能导致片段化和不准确性。本文介绍了一种将异常分数转换为分割掩模的方法，称为S2M，这是一种简单有效的语义分割中的分布之外对象检测框架。与将异常分数分配给像素不同，S2M直接分割整个分布之外对象。通过将异常分数转换为提示可分割模型的提示，S2M消除了对阈值选择的需求。大量实验证明，S2M在各种基准测试中，包括Fishyscapes、[[SegmentMeIfYouCan]] 和 RoadAnomaly 数据集，在IoU方面平均提高了约20%，在平均F1分数方面提高了约40%，优于现有技术。代码可在https://github.com/WenjieZhao1/S2M获得。

## 1. 引言 

语义分割是计算机视觉中的一个关键任务，在自动驾驶和航空图像分析等各种应用中具有重要意义。尽管当前的语义分割模型表现出色，但它们的实际部署仍然具有挑战性。其中一个重要障碍在于它们对于分布之外的对象的检测能力有限。具体而言，这些模型经常将分布之外对象内的像素分配给训练中使用的类别之一，导致分割掩模不准确。在语义分割中解决分布之外对象检测问题至关重要，因为分布之外对象掩模的不准确可能导致错误的结论，最终在自动驾驶等应用中引发安全问题。
    
现有的语义分割中的分布之外对象检测方法通过为每个像素分配异常分数来解决此问题。具有高异常分数的像素将被视为分布之外对象的一部分。这些异常分数通常由分割模型对每个像素的概率预测计算得出。例如，PEBAL提出了一种基于像素能量的分割方法来计算异常分数。RPL引入了残差模式学习模块，并通过基于能量的方法计算异常分数，从而有效地增强了模型对分布之外像素的敏感性，而不会损害对分布内数据的分割性能。尽管基于异常分数的分布之外对象检测方法可以准确识别异常像素，但它们缺乏一种有效的方法来分割整个分布之外对象。具体来说，为了为分布之外对象导出掩模，关键是使用精心选择的阈值来区分异常和正常像素。然而，在实际应用中确定最佳阈值可能是一项困难的任务。即使使用最佳阈值，基于异常分数的分布之外对象检测方法生成的掩模可能仍需要调整，因为某些像素的异常分数可能不准确，导致片段化或不连续的掩模。
    
为了解决这一问题，本文提出了一种名为S2M的方法，它将异常分数转换为分割掩模，是一种简单有效的语义分割中的分布之外对象检测框架。具体而言，S2M旨在通过直接分割整个分布之外对象来生成分布之外对象的掩模，而不是通过对异常分数进行阈值处理来导出掩模。因此，S2M有效地解决了使用阈值导致的片段化问题。更详细地说，给定由现有分布之外对象检测方法生成的任何异常分数，S2M使用提示生成器从中生成框提示。生成的框提示将近似定位分布之外对象。然后，框提示被用作提示可分割模型的输入，以生成分布之外对象的掩模。与使用阈值生成掩模不同，S2M生成的掩模准确地分割了整个分布之外对象，同时避免了将正常像素包含在掩模中。与现有的分布之外对象检测方法相比，S2M具有几个优点：1) 简单：S2M是一个简单的流程，易于训练和部署，无需超参数调整。2) 通用：S2M可以与任何基于异常分数的分布之外对象检测方法集成，以生成高质量的分布之外对象掩模。3) 有效：S2M可以准确地分割分布之外对象，而不会产生片段化和不准确的掩模。

本文的贡献如下：
- 我们提出了S2M，一种简单通用的管道，用于生成分布之外对象的精确掩模。
- 我们消除了手动选择生成分割掩模的最佳阈值的需要，这一步骤经常会增加部署的复杂性。此外，我们的方法是通用的，独立于特定的异常分数、提示生成器或提示可分割模型。
- 我们在包括 Fishyscapes, Segment-Me-If-You-Can 和RoadAnomaly数据集在内的常用分布之外对象分割基准上对S2M进行了广泛评估，结果表明，S2M在所有基准上平均提高了约20%的IoU和约40%的平均F1分数，改进了现有技术。

## 相关工作 

语义分割作为计算机视觉中的关键任务，在近年来取得了显著进展[13, 19, 21, 26, 43]。传统上，这个领域主要由像素级别分类方法主导，特别是受到全卷积网络（FCN）[33]的影响。这些方法通过保留高级图像表示和集成多尺度上下文信息，在生成详细分割方面表现出色，这在各种架构和方法中都有所体现。DeepLab系列通过使用扩张卷积来增强感受野，在这一领域取得了显著进展。DeepLabv3+ [44]利用空洞卷积来增强特征提取，并结合一个解码器模块来细化分割结果，特别是在物体边界处。 最近语义分割的趋势转向了基于Transformer的架构和注意力机制，这些方法提供了对图像内上下文关系的改进处理能力[13, 45, 52]。与这些典型的分割方法相比，基于提示的分割提供了一种独特的范式。它的主要优势在于其强大的分割能力，能够有效地在图像中勾勒出对象。例如，CLIPSeg [34]引入了一个系统，能够根据任何给定的提示（无论是文本还是图像）在测试时生成图像分割，从而实现了三个不同分割任务的统一模型。Segment Anything Model（SAM）[26]以其对每个对象生成精确掩码的强大能力而闻名，在对象分割任务中表现出卓越性能。 

像素级异常检测主要基于语义分割模型的输出。最初，许多异常检测方法采用数学方法，重点分析分割模型的置信度分布，以识别异常像素[27, 28, 31, 49]。例如，基于能量的方法[31]在任何模型上用能量函数代替softmax函数，以获取像素级别的异常分数，而不改变模型架构，并且引入了基于能量的正则化项，以针对性地微调模型。Synboost [11]通过使用学习权重对集成的不确定性图生成异常分数，有效地增强了异常检测，同时解决了过度自信的问题。DenseHybrid [17]通过使用混合异常检测方法获得异常分数。 在语义分割中的异常对象检测领域，正在发生显着的转变，即重新训练模型以更有效地提高它们对异常对象的敏感性[7, 12]。训练数据来自异常暴露（OE）过程，涉及将某些异常对象合并到分布图像中[23]，增强模型对异常的鲁棒性。尽管这些现有的异常检测模型根源于语义分割，但它们在输出格式上与传统的分割方法不同。这些异常检测方法不是根据置信度分数生成掩码，而是生成异常分数图作为输出。然而，使用异常分数图存在实际限制，因为它们在定位异常对象方面不如掩码准确。

## 方法 

我们采用简单而有效的流程来解决语义分割中的异常对象检测问题。我们的方法解决了现有基于异常分数的异常检测方法固有的局限性，这些方法主要提供像素级别的异常分数。虽然这些异常分数可以指示给定像素可能属于异常对象，但准确获取整个异常对象的分割掩码是困难的。相比之下，我们提出的S2M利用异常分数图创建框提示，以示存在异常对象。框提示作为可提示的分割框架的输入，该框架同时处理这些提示和原始图像，生成异常对象的分割掩码。该框架的训练流程如图3所示。

3.1. 图像到异常分数 
考虑一个表示为 $f(x;\theta)$ 的分割网络和一个输入图像 $x \in R^{H \times W \times 3}$，其中 $W$ 表示图像宽度，$H$ 表示图像高度。由分割网络产生的像素 $i$ 的 logit 可以表示为$L_i(x;\theta) = (f^1_i(x;\theta), f^2_i(x;\theta), ..., f^C_i(x;\theta))$，其中$C$表示类的总数。$L_i(x;\theta)$可以使用softmax函数进行归一化为$P_i(x;\theta)$。可以根据模型输出计算出异常分数$S_i(x;\theta)$。一种可能的异常分数，根据Shannon熵[11, 15]计算，定义为：...